<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>详情页</title>
		<link rel="stylesheet" type="text/css" href="css/css.css"/>
		<link rel="stylesheet" type="text/css" href="font_ugkes5u85ozp8pvi/iconfont.css"/>
		<link rel="stylesheet" type="text/css" href="css/Detail.css"/>
	</head>
	<body>
		<header style="height: 25px;" id="header-warp">
			<div class="top">
				<span>100%正品保证&nbsp;&nbsp;10年实力电商</span>
				<ul class="nav1">
					<li><a href="login.html" style="color: #E50163;">登录</a></li>
					<li><a href="zc.html" style="color: #E50163;">注册</a></li>
					<li><a  href="">微信
							<img class="nav-wx" src="img/160919171653.jpg" />
						</a>
					</li>
					<li><a href="">微博
							<img class="nav-wb" src="img/0826143310.jpg" />
						</a>
					</li>
					<li><a href="http://www.moonbasa.com/m/"><i class="iconfont">&#xe70f;</i>手机版</a></li>
					<li><a href="">收藏梦芭莎</a></li>
					<li><a href="">English</a></li>
					<li><a href="http://127.0.0.1/s-object/shoppingcar.html">购物车<i class="iconfont">&#xe887;</i></a></li>
				</ul>
			</div>
		</header>
		<div id="header">
			<a href="home-page.html"><img style="width: 232px;height: 26px;" src="img/logomoonbasa.png"/></a>
			<div class="header-box">
				<p><a href="home-page.html">梦芭莎职业优雅女装旗舰店</a></p>
				<p style="background: #000; color: #fff; cursor: pointer; width: 85px;">梦芭莎自营品牌</p>
			</div>
			<div class="search">
				<input type="text"  placeholder="秋上新第三波，复古新潮 领300元大红包即减" maxlength="20"/><span ><a href="#">搜索</a></span>
			</div>
		</div>
		<div id="title">
			<img src="img/detail.png" style="margin: 0 auto;"/>
		</div>
		<div id="nav" style=" background: #eee;">
			<ul>
				<li><a href="md-sy.html">首页</a></li>
 				<li><a href="" style="color: #f00;">2017新品</a><span>NEW</span></li>
 				<li><a href="">连衣裙</a><span>HOT</span></li>
 				<li><a href="">小衫衬衫</a></li>
 				<li><a href="">T恤</a></li>
 				<li><a href="">半裙</a></li>
 				<li><a href="">外套</a></li>
 				<li><a href="">裤装</a></li>
 				<li><a href="" style="color: #f00">折扣区</a></li>
			</ul>
		</div>
		<!--详情-->
		<div id="main">
			<!--<div class="box">
				<div class="smallImgs">
					<img src="img/imgs/02.jpg" />
					<div id="mask"></div>
				</div>
				<div class="bigImgs">
					<img src="img/imgs/02.jpg" />
				</div>
			</div>
			<div class="content">
				<h2>梦芭莎时尚拼接落肩亮片宽松圆领百搭小衫</h2>
				<div id="price">￥<span id="money">99</span></div>
				<div id="color">
					颜色:
					<p title="黑色">黑色</p>
					<p title="白色">白色</p>
				</div>
				<div id="size">
					尺寸：
					<p title="S">S</p>
					<p title="M">M</p>
					<p title="X">X</p>
					<p title="XL">XL</p>
				</div>
				<div id="num">
					数量：<input type="number" max="5" value="1" min="1"  style=" font-size: 20px; width: 50px; margin: 0 10px;"/>现在有货
				</div>
				<div style="display: flex; justify-content: space-around;"><a href="shoppingcar.html" id="shop">立即购买</a><a id="tocar">加入购物车</a></div>
				<div id="content-btm" >
					<span>7天无条件退换货</span>
					<span>满180元免运费</span>
					<span>梦芭莎发货</span></div>
			</div>
			<div id="main-right">
				<p>看了又看</p>
				<dl>
					<dt><img src="img/main-r1.JPG"/></dt>
					<dd>￥139</dd>
				</dl>
				<dl>
					<dt><img src="img/main-r2.JPG"/></dt>
					<dd>￥129</dd>
				</dl>
				<dl>
					<dt><img src="img/main-r3.JPG"/></dt>
					<dd>￥129</dd>
				</dl>
			</div>-->
		</div>
		
		<div id="content">
			<div class="cont-l">
				<img src="img/Dateil-img/M9_5_95629.jpg" />
				<img src="img/Dateil-img/M9_5_102754.jpg" />
				<p style="margin: 10px; width: 168px; height: 40px; line-height: 40px; color: #E50163; border-bottom: 1px solid #0086B3; border-top: 1px solid #0086B3; text-align: center; font-size: 14px;">看了又买了</p>
				<img src="img/imgs/02.jpg" />
				<img src="img/imgs/01.jpg" />
				<img src="img/imgs/03.jpg" />
				<img src="img/imgs/05.jpg" />
			</div>
			<div class="cont-r">
				<ul class="cont-nav">
					<li>商品详情</li>
					<li>如何支付</li>
					<li>7天无条件退货</li>
				</ul>
				<div class="cont-c">
					<div class="one">
						<img style="margin-bottom: 20px;" src="img/Dateil-img/t_03.png"/>
						<img src="img/Dateil-img/970141188_0.jpg"/>
						<img src="img/Dateil-img/970141188_300.jpg"/>
						<img src="img/Dateil-img/970141188_600.jpg"/>
						<img src="img/Dateil-img/970141188_900.jpg"/>
						<img src="img/Dateil-img/970141188_1200.jpg"/>
						<img src="img/Dateil-img/970141188_1500.jpg"/>
						<img src="img/Dateil-img/970141188_1800.jpg"/>
						<img src="img/Dateil-img/970141188_2100.jpg"/>
						<img src="img/Dateil-img/970141188_2400.jpg"/>
						<img src="img/Dateil-img/970141188_2700.jpg"/>
						<img src="img/Dateil-img/970141188_3000.jpg"/>
					</div>
					<div class="two">
						<img src="img/Dateil-img/htp.jpg" />
						<img src="img/Dateil-img/qq1.png" />
					</div>
					<div class="three">
						<img src="img/Dateil-img/htch.jpg" />
					</div>
				</div>
			</div>
		</div>
		
		<!--底部-->
		<div id="footer-warp"></div>
		<!--右侧边栏-->
		<div id="right">
				<a href="#"><i class="iconfont">&#xe659;</i>
					<div class="me">
						<img src="img/default-head.jpg" />
						<div><span id="dl">登录</span><span id="zc">注册</span></div>
					</div>
									
				</a>
				<a  class="right-shopcar"><i class="iconfont">&#xe887;</i>购物车<span id="num">0</span>
					<div>
						<div class="car-top">
							<p>购物车</p><p>×</p>
						</div>
						<div style="height: 40px; text-align: left; border-bottom: 1px solid #999999; line-height: 40px; padding-left: 20px;">梦芭莎</div>
						<div id="car-main">
							<!--<dl>
								<dt><img src="img/imgs/02.jpg"/></dt>
								<dd>
									<h4>梦芭莎创意撞料拼接荷叶小立领喇叭袖百搭衬衫</h4>
									<p>S 黑色</p>
									<div class="money"><span>￥269</span>*1</div>
								</dd>
							</dl>-->
								
						</div>
					</div>
				</a>
				<a href="#" class="right-like marg"><i class="iconfont i">&#xe707;</i><div>我的收藏</div></a>
				<a href="#" class="rigjt-wx marg"><i class="iconfont i">&#xe65a;</i><div><img src="img/right-wx2wm.png" /></div></a>
				<a href="#" class="right-kf marg"><i class="iconfont i">&#xe625;</i><div>联系客服</div></a>
				<a href="#" class="right-2wm marg"><i class="iconfont i">&#xe642;</i><div><img src="img/right-2wm.png" /> </div></a>
				<a class="right-top marg"><i class="iconfont i">&#xe62d;</i>TOP<div>返回顶部</div></a>
		</div>
	</body>
</html>
<script src="js/jquery.min.js"></script>
<script src="js/cookie.js"></script>
<script src="js/right.js"></script>
<script src="js/Detail-content.js"></script>
<script>
	$("#footer-warp").load("all.html #bottom-all")
	var str = location.href;
	var arr = str.split("?")[1];
	var pid = arr.split("&")[0].split("=")[1];
	$.ajax({
		type:"get",
		url:"http://127.0.0.1/s-object/js/data.json",
		success : function(res){
			var str = "";
			for(var i in res){
				if( pid == res[i].id ){//找到了要显示的商品详情
					str = `<div class="box">
							<div class="smallImgs">
								<img src="img/imgs/${res[i].src}" />
								<div id="mask"></div>
							</div>
							<div class="bigImgs">
								<img src="img/imgs/${res[i].src}" />
							</div>
						</div>
						<div class="content">
							<h2>${res[i].name}</h2>
							<div id="price">￥
							<span>${res[i].price}</span>
							</div>
							<div id="color">
								颜色:
								<p title="黑色">黑色</p>
								<p title="白色">白色</p>
							</div>
							<div id="size">
								尺寸：
								<p title="S">S</p>
								<p title="M">M</p>
								<p title="X">X</p>
								<p title="XL">XL</p>
							</div>
							<div id="num">
								数量：<input type="number" max="5" value="1" min="1"  style=" font-size: 20px; width: 50px; margin: 0 10px;"/>现在有货
							</div>
							<div style="display: flex; justify-content: space-around;">
								<a href="http://127.0.0.1/s-object/shoppingcar.html" id="shop">立即购买</a>
								<a id="tocar">加入购物车</a>
								<span data-id=${res[i].id}  data-name=${res[i].name} data-src=${res[i].src} data-price=${res[i].price}  style="display:none"></span>
							</div>
							<div id="content-btm" >
								<span>7天无条件退换货</span>
								<span>满180元免运费</span>
								<span>梦芭莎发货</span>
							</div>
						</div>
						<div id="main-right">
							<p>看了又看</p>
							<dl>
								<dt><img src="img/main-r1.JPG"/></dt>
								<dd>￥139</dd>
							</dl>
							<dl>
								<dt><img src="img/main-r2.JPG"/></dt>
								<dd>￥129</dd>
							</dl>
							<dl>
								<dt><img src="img/main-r3.JPG"/></dt>
								<dd>￥129</dd>
							</dl>
						</div>`;		
				}
			}
			$("#main").html(str);
			//放大镜
			$(".smallImgs").mouseenter(function(){
				$("#mask").show()
				$(".bigImgs").show()
			}).mouseleave(function(){
				$("#mask").hide()
				$(".bigImgs").hide()
			})
				$(".smallImgs").mousemove(function(e){
					var e=e||event;
					var x=e.pageX-$(".box")[0].offsetLeft-$("#mask").width()/2;
					var y=e.pageY-$(".box")[0].offsetTop-$("#mask").height()/2;
					var maxLeft=$(".smallImgs").width()-$("#mask").width();
					var maxTop=$(".smallImgs").height()-$("#mask").height();
					x=x<0?0:(x>maxLeft?maxLeft:x);
					y=y<0?0:(y>maxTop?maxTop:y)
					$("#mask")[0].style.left=x+"px";
					$("#mask")[0].style.top=y+"px";
					$(".bigImgs>img")[0].style.left=-x*$(".bigImgs>img").width()/$(".smallImgs").width()+"px"
					$(".bigImgs>img")[0].style.top=-y*$(".bigImgs>img").height()/$(".smallImgs").height()+"px"
					//console.log(x+""+y)
				})
			window.getSelection().removeAllRanges();
			
			$("#size>p:first").css("border","2px solid #E50163")
			$("#color>p:first").css("border","2px solid #E50163")
			$("#size").on("click","p",function(){
				$(this).css("border","2px solid #E50163").siblings("p").css("border","2px solid #ccc")
			})
			$("#color").on("click","p",function(){

				$(this).css("border","2px solid #E50163").siblings("p").css("border","2px solid #ccc")
			})
			//存cookie
			
			
			$("#tocar").click(function(){
				var arr = [];
				var flag = true;//可以向数组中添加数据
				var _json = {
					id:$(this).next("span").data("id"),
					name:$(this).next("span").data("name"),
					src:$(this).next("span").data("src"),
					price:$(this).next("span").data("price"),
					count:1
				}
				//console.log(document.cookie)
				//当再次点击按钮时，cookie信息被覆盖  解决 ： 先取出cookie数据 存入到数组中，然后在把新增的商品存入到数组中
				var cookieInfo = getCookie("shoplist");
				if( cookieInfo.length != 0 ){//表示cookie中有数据
					arr = cookieInfo;
					//点击相同商品时，需要做商品数量的累加    用当前点击的商品编号id   和  取出来的cookie的 数据中商品id做比较 发现有相等的，count++
					for(var i in arr){
						if(_json.id == arr[i].id){
							arr[i].count++;
							flag = false;
							break;
						}
					}
				}
				if(flag){
					arr.push(_json);
				}
				setCookie("shoplist",JSON.stringify(arr));
				var f = confirm("是否继续购买?确定--继续购买，取消---去购物车结算");
				if( !f ){
					location.href = "http://127.0.0.1/s-object/shoppingcar.html";
				}else{
					location.reload()
				}
				console.log( document.cookie );
			})
		}
	});
	
	var _arr = getCookie("shoplist");
	//console.log(arr)
	var num=0
	for(var i in _arr){
		num+=_arr[i].count
	}
	$("#num").html(num)
	
</script>

<script>
	//侧边栏购物车
	var shopCookie=getCookie("shoplist");
	var htmls=""
	for(var j in shopCookie){
		htmls+=`<dl>
					<dt><img style="width:36px; height:48px"  src="img/imgs/${shopCookie[j].src}"/></dt>
					<dd>
						<h4>${shopCookie[j].name}</h4>
						<p>S 黑色</p>
						<div class="money"><span>￥${shopCookie[j].price}</span>*${shopCookie[j].count}</div>
					</dd>
				</dl>`
	}
	if(htmls==""){
		htmls+=`<p style="position: absolute; top: 200px;left: 90px; color: #E50163;">您还没有选择商品</p>`
	}
	$("#car-main").html(htmls)
</script>